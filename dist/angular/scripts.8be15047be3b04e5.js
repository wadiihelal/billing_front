!function(r,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define("keycloak",a):(r="undefined"!=typeof globalThis?globalThis:r||self).Keycloak=a()}(this,function(){"use strict";var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var es6Promise_min={exports:{}},r;r=es6Promise_min,r.exports=function(){function e(n){return"function"==typeof n}function L(){var n=setTimeout;return function(){return n(U,1)}}function U(){for(var n=0;n<A;n+=2)(0,ee[n])(ee[n+1]),ee[n]=void 0,ee[n+1]=void 0;A=0}function T(n,l){var k=this,w=new this.constructor(O);void 0===w[ce]&&f(w);var b=k._state;if(b){var E=arguments[b-1];M(function(){return ne(b,w,E,k._result)})}else G(k,w,n,l);return w}function N(n){if(n&&"object"==typeof n&&n.constructor===this)return n;var k=new this(O);return z(k,n),k}function O(){}function Z(n,l,k){l.constructor===n.constructor&&k===T&&l.constructor.resolve===N?function P(n,l){l._state===ie?J(n,l._result):l._state===re?j(n,l._result):G(l,void 0,function(k){return z(n,k)},function(k){return j(n,k)})}(n,l):void 0===k?J(n,l):e(k)?function ae(n,l,k){M(function(w){var b=!1,E=function V(n,l,k,w){try{n.call(l,k,w)}catch(b){return b}}(k,l,function(F){b||(b=!0,l!==F?z(w,F):J(w,F))},function(F){b||(b=!0,j(w,F))});!b&&E&&(b=!0,j(w,E))},n)}(n,l,k):J(n,l)}function z(n,l){if(n===l)j(n,function X(){return new TypeError("You cannot resolve a promise with itself")}());else if(function m(n){var l=typeof n;return null!==n&&("object"===l||"function"===l)}(l)){var k=void 0;try{k=l.then}catch(w){return void j(n,w)}Z(n,l,k)}else J(n,l)}function $(n){n._onerror&&n._onerror(n._result),Q(n)}function J(n,l){n._state===te&&(n._result=l,n._state=ie,0!==n._subscribers.length&&M(Q,n))}function j(n,l){n._state===te&&(n._state=re,n._result=l,M($,n))}function G(n,l,k,w){var b=n._subscribers,E=b.length;n._onerror=null,b[E]=l,b[E+ie]=k,b[E+re]=w,0===E&&n._state&&M(Q,n)}function Q(n){var l=n._subscribers,k=n._state;if(0!==l.length){for(var w=void 0,b=void 0,E=n._result,F=0;F<l.length;F+=3)b=l[F+k],(w=l[F])?ne(k,w,b,E):b(E);n._subscribers.length=0}}function ne(n,l,k,w){var b=e(k),E=void 0,F=void 0,oe=!0;if(b){try{E=k(w)}catch(se){oe=!1,F=se}if(l===E)return void j(l,function B(){return new TypeError("A promises callback cannot return that same promise.")}())}else E=w;l._state!==te||(b&&oe?z(l,E):!1===oe?j(l,F):n===ie?J(l,E):n===re&&j(l,E))}function f(n){n[ce]=fe++,n._state=void 0,n._result=void 0,n._subscribers=[]}var x=Array.isArray?Array.isArray:function(n){return"[object Array]"===Object.prototype.toString.call(n)},A=0,Y=void 0,q=void 0,M=function(n,l){ee[A]=n,ee[A+1]=l,2===(A+=2)&&(q?q(U):de())},W="undefined"!=typeof window?window:void 0,le=W||{},he=le.MutationObserver||le.WebKitMutationObserver,pe="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),me="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ee=new Array(1e3),de=void 0;de=pe?function y(){return function(){return process.nextTick(U)}}():he?function R(){var n=0,l=new he(U),k=document.createTextNode("");return l.observe(k,{characterData:!0}),function(){k.data=n=++n%2}}():me?function C(){var n=new MessageChannel;return n.port1.onmessage=U,function(){return n.port2.postMessage(0)}}():void 0===W&&"function"==typeof commonjsRequire?function H(){try{var n=Function("return this")().require("vertx");return Y=n.runOnLoop||n.runOnContext,function g(){return void 0!==Y?function(){Y(U)}:L()}()}catch(l){return L()}}():L();var ce=Math.random().toString(36).substring(2),te=void 0,ie=1,re=2,fe=0,ve=function(){function n(l,k){this._instanceConstructor=l,this.promise=new l(O),this.promise[ce]||f(this.promise),x(k)?(this.length=k.length,this._remaining=k.length,this._result=new Array(this.length),0===this.length?J(this.promise,this._result):(this.length=this.length||0,this._enumerate(k),0===this._remaining&&J(this.promise,this._result))):j(this.promise,function s(){return new Error("Array Methods must be provided an Array")}())}return n.prototype._enumerate=function(l){for(var k=0;this._state===te&&k<l.length;k++)this._eachEntry(l[k],k)},n.prototype._eachEntry=function(l,k){var w=this._instanceConstructor,b=w.resolve;if(b===N){var E=void 0,F=void 0,oe=!1;try{E=l.then}catch(ue){oe=!0,F=ue}if(E===T&&l._state!==te)this._settledAt(l._state,k,l._result);else if("function"!=typeof E)this._remaining--,this._result[k]=l;else if(w===D){var se=new w(O);oe?j(se,F):Z(se,l,E),this._willSettleAt(se,k)}else this._willSettleAt(new w(function(ue){return ue(l)}),k)}else this._willSettleAt(b(l),k)},n.prototype._settledAt=function(l,k,w){var b=this.promise;b._state===te&&(this._remaining--,l===re?j(b,w):this._result[k]=w),0===this._remaining&&J(b,this._result)},n.prototype._willSettleAt=function(l,k){var w=this;G(l,void 0,function(b){return w._settledAt(ie,k,b)},function(b){return w._settledAt(re,k,b)})},n}(),D=function(){function n(l){this[ce]=function o(){return fe++}(),this._result=this._state=void 0,this._subscribers=[],O!==l&&("function"!=typeof l&&function p(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof n?function t(n,l){try{l(function(k){z(n,k)},function(k){j(n,k)})}catch(k){j(n,k)}}(this,l):function _(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return n.prototype.catch=function(l){return this.then(null,l)},n.prototype.finally=function(l){var k=this,w=k.constructor;return e(l)?k.then(function(b){return w.resolve(l()).then(function(){return b})},function(b){return w.resolve(l()).then(function(){throw b})}):k.then(l,l)},n}();return D.prototype.then=T,D.all=function h(n){return new ve(this,n).promise},D.race=function v(n){var l=this;return new l(x(n)?function(k,w){for(var b=n.length,E=0;E<b;E++)l.resolve(n[E]).then(k,w)}:function(k,w){return w(new TypeError("You must pass an array to race."))})},D.resolve=N,D.reject=function c(n){var l=new this(O);return j(l,n),l},D._setScheduler=function u(n){q=n},D._setAsap=function d(n){M=n},D._asap=M,D.polyfill=function S(){var n=void 0;if(void 0!==commonjsGlobal)n=commonjsGlobal;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(w){throw new Error("polyfill failed because global object is unavailable in this environment")}var l=n.Promise;if(l){var k=null;try{k=Object.prototype.toString.call(l.resolve())}catch(w){}if("[object Promise]"===k&&!l.cast)return}n.Promise=D},D.Promise=D,D}();var base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(r){var a=r.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var m=r.indexOf("=");return-1===m&&(m=a),[m,m===a?0:4-m%4]}function byteLength(r){var a=getLens(r),e=a[1];return 3*(a[0]+e)/4-e}function _byteLength(r,a,m){return 3*(a+m)/4-m}function toByteArray(r){var a,m,e=getLens(r),u=e[0],d=e[1],y=new Arr(_byteLength(r,u,d)),g=0,R=d>0?u-4:u;for(m=0;m<R;m+=4)a=revLookup[r.charCodeAt(m)]<<18|revLookup[r.charCodeAt(m+1)]<<12|revLookup[r.charCodeAt(m+2)]<<6|revLookup[r.charCodeAt(m+3)],y[g++]=a>>16&255,y[g++]=a>>8&255,y[g++]=255&a;return 2===d&&(a=revLookup[r.charCodeAt(m)]<<2|revLookup[r.charCodeAt(m+1)]>>4,y[g++]=255&a),1===d&&(a=revLookup[r.charCodeAt(m)]<<10|revLookup[r.charCodeAt(m+1)]<<4|revLookup[r.charCodeAt(m+2)]>>2,y[g++]=a>>8&255,y[g++]=255&a),y}function tripletToBase64(r){return lookup[r>>18&63]+lookup[r>>12&63]+lookup[r>>6&63]+lookup[63&r]}function encodeChunk(r,a,m){for(var u=[],d=a;d<m;d+=3)u.push(tripletToBase64((r[d]<<16&16711680)+(r[d+1]<<8&65280)+(255&r[d+2])));return u.join("")}function fromByteArray(r){for(var a,m=r.length,e=m%3,u=[],d=16383,y=0,g=m-e;y<g;y+=d)u.push(encodeChunk(r,y,y+d>g?g:y+d));return 1===e?u.push(lookup[(a=r[m-1])>>2]+lookup[a<<4&63]+"=="):2===e&&u.push(lookup[(a=(r[m-2]<<8)+r[m-1])>>10]+lookup[a>>4&63]+lookup[a<<2&63]+"="),u.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;var sha256={exports:{}};if(function(module){(function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(r){return"[object Array]"===Object.prototype.toString.call(r)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(r){return"object"==typeof r&&r.buffer&&r.buffer.constructor===ArrayBuffer});var createOutputMethod=function(r,a){return function(m){return new Sha256(a,!0).update(m)[r]()}},createMethod=function(r){var a=createOutputMethod("hex",r);NODE_JS&&(a=nodeWrap(a,r)),a.create=function(){return new Sha256(r)},a.update=function(u){return a.create().update(u)};for(var m=0;m<OUTPUT_TYPES.length;++m){var e=OUTPUT_TYPES[m];a[e]=createOutputMethod(e,r)}return a},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(r){if("string"==typeof r)return crypto.createHash(algorithm).update(r,"utf8").digest("hex");if(null==r)throw new Error(ERROR);return r.constructor===ArrayBuffer&&(r=new Uint8Array(r)),Array.isArray(r)||ArrayBuffer.isView(r)||r.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(r)).digest("hex"):method(r)};return nodeMethod},createHmacOutputMethod=function(r,a){return function(m,e){return new HmacSha256(m,a,!0).update(e)[r]()}},createHmacMethod=function(r){var a=createHmacOutputMethod("hex",r);a.create=function(u){return new HmacSha256(u,r)},a.update=function(u,d){return a.create(u).update(d)};for(var m=0;m<OUTPUT_TYPES.length;++m){var e=OUTPUT_TYPES[m];a[e]=createHmacOutputMethod(e,r)}return a};function Sha256(r,a){a?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=r}function HmacSha256(r,a,m){var e,u=typeof r;if("string"===u){var d,y=[],g=r.length,R=0;for(e=0;e<g;++e)(d=r.charCodeAt(e))<128?y[R++]=d:d<2048?(y[R++]=192|d>>6,y[R++]=128|63&d):d<55296||d>=57344?(y[R++]=224|d>>12,y[R++]=128|d>>6&63,y[R++]=128|63&d):(d=65536+((1023&d)<<10|1023&r.charCodeAt(++e)),y[R++]=240|d>>18,y[R++]=128|d>>12&63,y[R++]=128|d>>6&63,y[R++]=128|63&d);r=y}else{if("object"!==u)throw new Error(ERROR);if(null===r)throw new Error(ERROR);if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!(Array.isArray(r)||ARRAY_BUFFER&&ArrayBuffer.isView(r)))throw new Error(ERROR)}r.length>64&&(r=new Sha256(a,!0).update(r).array());var C=[],L=[];for(e=0;e<64;++e){var U=r[e]||0;C[e]=92^U,L[e]=54^U}Sha256.call(this,a,m),this.update(L),this.oKeyPad=C,this.inner=!0,this.sharedMemory=m}Sha256.prototype.update=function(r){if(!this.finalized){var a,m=typeof r;if("string"!==m){if("object"!==m)throw new Error(ERROR);if(null===r)throw new Error(ERROR);if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!(Array.isArray(r)||ARRAY_BUFFER&&ArrayBuffer.isView(r)))throw new Error(ERROR);a=!0}for(var e,u,d=0,y=r.length,g=this.blocks;d<y;){if(this.hashed&&(this.hashed=!1,g[0]=this.block,g[16]=g[1]=g[2]=g[3]=g[4]=g[5]=g[6]=g[7]=g[8]=g[9]=g[10]=g[11]=g[12]=g[13]=g[14]=g[15]=0),a)for(u=this.start;d<y&&u<64;++d)g[u>>2]|=r[d]<<SHIFT[3&u++];else for(u=this.start;d<y&&u<64;++d)(e=r.charCodeAt(d))<128?g[u>>2]|=e<<SHIFT[3&u++]:e<2048?(g[u>>2]|=(192|e>>6)<<SHIFT[3&u++],g[u>>2]|=(128|63&e)<<SHIFT[3&u++]):e<55296||e>=57344?(g[u>>2]|=(224|e>>12)<<SHIFT[3&u++],g[u>>2]|=(128|e>>6&63)<<SHIFT[3&u++],g[u>>2]|=(128|63&e)<<SHIFT[3&u++]):(e=65536+((1023&e)<<10|1023&r.charCodeAt(++d)),g[u>>2]|=(240|e>>18)<<SHIFT[3&u++],g[u>>2]|=(128|e>>12&63)<<SHIFT[3&u++],g[u>>2]|=(128|e>>6&63)<<SHIFT[3&u++],g[u>>2]|=(128|63&e)<<SHIFT[3&u++]);this.lastByteIndex=u,this.bytes+=u-this.start,u>=64?(this.block=g[16],this.start=u-64,this.hash(),this.hashed=!0):this.start=u}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var r=this.blocks,a=this.lastByteIndex;r[16]=this.block,r[a>>2]|=EXTRA[3&a],this.block=r[16],a>=56&&(this.hashed||this.hash(),r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),r[14]=this.hBytes<<3|this.bytes>>>29,r[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var r,a,m,e,u,d,y,g,R,C=this.h0,L=this.h1,U=this.h2,H=this.h3,T=this.h4,N=this.h5,O=this.h6,X=this.h7,B=this.blocks;for(r=16;r<64;++r)a=((u=B[r-15])>>>7|u<<25)^(u>>>18|u<<14)^u>>>3,m=((u=B[r-2])>>>17|u<<15)^(u>>>19|u<<13)^u>>>10,B[r]=B[r-16]+a+B[r-7]+m<<0;for(R=L&U,r=0;r<64;r+=4)this.first?(this.is224?(d=300032,X=(u=B[0]-1413257819)-150054599<<0,H=u+24177077<<0):(d=704751109,X=(u=B[0]-210244248)-1521486534<<0,H=u+143694565<<0),this.first=!1):(e=(d=C&L)^C&U^R,X=H+(u=X+(m=(T>>>6|T<<26)^(T>>>11|T<<21)^(T>>>25|T<<7))+(T&N^~T&O)+K[r]+B[r])<<0,H=u+((a=(C>>>2|C<<30)^(C>>>13|C<<19)^(C>>>22|C<<10))+e)<<0),e=(y=H&C)^H&L^d,O=U+(u=O+(m=(X>>>6|X<<26)^(X>>>11|X<<21)^(X>>>25|X<<7))+(X&T^~X&N)+K[r+1]+B[r+1])<<0,a=((U=u+((a=(H>>>2|H<<30)^(H>>>13|H<<19)^(H>>>22|H<<10))+e)<<0)>>>2|U<<30)^(U>>>13|U<<19)^(U>>>22|U<<10),e=(g=U&H)^U&C^y,N=L+(u=N+(m=(O>>>6|O<<26)^(O>>>11|O<<21)^(O>>>25|O<<7))+(O&X^~O&T)+K[r+2]+B[r+2])<<0,a=((L=u+(a+e)<<0)>>>2|L<<30)^(L>>>13|L<<19)^(L>>>22|L<<10),e=(R=L&U)^L&H^g,T=C+(u=T+(m=(N>>>6|N<<26)^(N>>>11|N<<21)^(N>>>25|N<<7))+(N&O^~N&X)+K[r+3]+B[r+3])<<0,C=u+(a+e)<<0;this.h0=this.h0+C<<0,this.h1=this.h1+L<<0,this.h2=this.h2+U<<0,this.h3=this.h3+H<<0,this.h4=this.h4+T<<0,this.h5=this.h5+N<<0,this.h6=this.h6+O<<0,this.h7=this.h7+X<<0},Sha256.prototype.hex=function(){this.finalize();var r=this.h0,a=this.h1,m=this.h2,e=this.h3,u=this.h4,d=this.h5,y=this.h6,g=this.h7,R=HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]+HEX_CHARS[m>>28&15]+HEX_CHARS[m>>24&15]+HEX_CHARS[m>>20&15]+HEX_CHARS[m>>16&15]+HEX_CHARS[m>>12&15]+HEX_CHARS[m>>8&15]+HEX_CHARS[m>>4&15]+HEX_CHARS[15&m]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[u>>28&15]+HEX_CHARS[u>>24&15]+HEX_CHARS[u>>20&15]+HEX_CHARS[u>>16&15]+HEX_CHARS[u>>12&15]+HEX_CHARS[u>>8&15]+HEX_CHARS[u>>4&15]+HEX_CHARS[15&u]+HEX_CHARS[d>>28&15]+HEX_CHARS[d>>24&15]+HEX_CHARS[d>>20&15]+HEX_CHARS[d>>16&15]+HEX_CHARS[d>>12&15]+HEX_CHARS[d>>8&15]+HEX_CHARS[d>>4&15]+HEX_CHARS[15&d]+HEX_CHARS[y>>28&15]+HEX_CHARS[y>>24&15]+HEX_CHARS[y>>20&15]+HEX_CHARS[y>>16&15]+HEX_CHARS[y>>12&15]+HEX_CHARS[y>>8&15]+HEX_CHARS[y>>4&15]+HEX_CHARS[15&y];return this.is224||(R+=HEX_CHARS[g>>28&15]+HEX_CHARS[g>>24&15]+HEX_CHARS[g>>20&15]+HEX_CHARS[g>>16&15]+HEX_CHARS[g>>12&15]+HEX_CHARS[g>>8&15]+HEX_CHARS[g>>4&15]+HEX_CHARS[15&g]),R},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var r=this.h0,a=this.h1,m=this.h2,e=this.h3,u=this.h4,d=this.h5,y=this.h6,g=this.h7,R=[r>>24&255,r>>16&255,r>>8&255,255&r,a>>24&255,a>>16&255,a>>8&255,255&a,m>>24&255,m>>16&255,m>>8&255,255&m,e>>24&255,e>>16&255,e>>8&255,255&e,u>>24&255,u>>16&255,u>>8&255,255&u,d>>24&255,d>>16&255,d>>8&255,255&d,y>>24&255,y>>16&255,y>>8&255,255&y];return this.is224||R.push(g>>24&255,g>>16&255,g>>8&255,255&g),R},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var r=new ArrayBuffer(this.is224?28:32),a=new DataView(r);return a.setUint32(0,this.h0),a.setUint32(4,this.h1),a.setUint32(8,this.h2),a.setUint32(12,this.h3),a.setUint32(16,this.h4),a.setUint32(20,this.h5),a.setUint32(24,this.h6),this.is224||a.setUint32(28,this.h7),r},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var r=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(r),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()}(sha256),void 0===es6Promise_min.exports.Promise)throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");var loggedPromiseDeprecation=!1;function logPromiseDeprecation(){loggedPromiseDeprecation||(loggedPromiseDeprecation=!0,console.warn("[KEYCLOAK] Usage of legacy style promise methods such as `.error()` and `.success()` has been deprecated and support will be removed in future versions. Use standard style promise methods such as `.then() and `.catch()` instead."))}function Keycloak(r){if(!(this instanceof Keycloak))return new Keycloak(r);for(var a,m,e=this,u=[],d={enable:!0,callbackList:[],interval:5},y=document.getElementsByTagName("script"),g=0;g<y.length;g++)-1===y[g].src.indexOf("keycloak.js")&&-1===y[g].src.indexOf("keycloak.min.js")||-1===y[g].src.indexOf("version=")||(e.iframeVersion=y[g].src.substring(y[g].src.indexOf("version=")+8).split("&")[0]);var R=!0,C=ne(console.info),L=ne(console.warn);function U(t,o){for(var f=function(v){var c=null,p=window.crypto||window.msCrypto;if(p&&p.getRandomValues&&window.Uint8Array)return c=new Uint8Array(v),p.getRandomValues(c),c;c=new Array(v);for(var _=0;_<c.length;_++)c[_]=Math.floor(256*Math.random());return c}(t),s=new Array(t),h=0;h<t;h++)s[h]=o.charCodeAt(f[h]%o.length);return String.fromCharCode.apply(null,s)}function H(){return void 0!==e.authServerUrl?"/"==e.authServerUrl.charAt(e.authServerUrl.length-1)?e.authServerUrl+"realms/"+encodeURIComponent(e.realm):e.authServerUrl+"/realms/"+encodeURIComponent(e.realm):void 0}function T(t,o){var f=t.code,s=t.error,h=t.prompt,v=(new Date).getTime();if(t.kc_action_status&&e.onActionUpdate&&e.onActionUpdate(t.kc_action_status),s)if("none"!=h){var c={error:s,error_description:t.error_description};e.onAuthError&&e.onAuthError(c),o&&o.setError(c)}else o&&o.setSuccess();else if("standard"!=e.flow&&(t.access_token||t.id_token)&&I(t.access_token,null,t.id_token,!0),"implicit"!=e.flow&&f){var p="code="+f+"&grant_type=authorization_code",_=e.endpoints.token(),S=new XMLHttpRequest;S.open("POST",_,!0),S.setRequestHeader("Content-type","application/x-www-form-urlencoded"),p+="&client_id="+encodeURIComponent(e.clientId),p+="&redirect_uri="+t.redirectUri,t.pkceCodeVerifier&&(p+="&code_verifier="+t.pkceCodeVerifier),S.withCredentials=!0,S.onreadystatechange=function(){if(4==S.readyState)if(200==S.status){var x=JSON.parse(S.responseText);I(x.access_token,x.refresh_token,x.id_token,"standard"===e.flow),z()}else e.onAuthError&&e.onAuthError(),o&&o.setError()},S.send(p)}function I(x,A,Y,q){O(x,A,Y,v=(v+(new Date).getTime())/2),R&&(e.tokenParsed&&e.tokenParsed.nonce!=t.storedNonce||e.refreshTokenParsed&&e.refreshTokenParsed.nonce!=t.storedNonce||e.idTokenParsed&&e.idTokenParsed.nonce!=t.storedNonce)?(C("[KEYCLOAK] Invalid nonce, clearing token"),e.clearToken(),o&&o.setError()):q&&(e.onAuthSuccess&&e.onAuthSuccess(),o&&o.setSuccess())}}function N(t){return 0==t.status&&t.responseText&&t.responseURL.startsWith("file:")}function O(t,o,f,s){if(e.tokenTimeoutHandle&&(clearTimeout(e.tokenTimeoutHandle),e.tokenTimeoutHandle=null),o?(e.refreshToken=o,e.refreshTokenParsed=X(o)):(delete e.refreshToken,delete e.refreshTokenParsed),f?(e.idToken=f,e.idTokenParsed=X(f)):(delete e.idToken,delete e.idTokenParsed),t){if(e.token=t,e.tokenParsed=X(t),e.sessionId=e.tokenParsed.session_state,e.authenticated=!0,e.subject=e.tokenParsed.sub,e.realmAccess=e.tokenParsed.realm_access,e.resourceAccess=e.tokenParsed.resource_access,s&&(e.timeSkew=Math.floor(s/1e3)-e.tokenParsed.iat),null!=e.timeSkew&&(C("[KEYCLOAK] Estimated time difference between browser and server is "+e.timeSkew+" seconds"),e.onTokenExpired)){var h=1e3*(e.tokenParsed.exp-(new Date).getTime()/1e3+e.timeSkew);C("[KEYCLOAK] Token expires in "+Math.round(h/1e3)+" s"),h<=0?e.onTokenExpired():e.tokenTimeoutHandle=setTimeout(e.onTokenExpired,h)}}else delete e.token,delete e.tokenParsed,delete e.subject,delete e.realmAccess,delete e.resourceAccess,e.authenticated=!1}function X(t){switch((t=(t=(t=t.split(".")[1]).replace(/-/g,"+")).replace(/_/g,"/")).length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Invalid token"}return t=decodeURIComponent(escape(atob(t))),JSON.parse(t)}function B(){var t="0123456789abcdef",o=U(36,t).split("");return o[14]="4",o[19]=t.substr(3&o[19]|8,1),o[8]=o[13]=o[18]=o[23]="-",o.join("")}function V(t){var o=function(s){var h;switch(e.flow){case"standard":h=["code","state","session_state","kc_action_status"];break;case"implicit":h=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status"];break;case"hybrid":h=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status"]}h.push("error"),h.push("error_description"),h.push("error_uri");var v,c,p=s.indexOf("?"),_=s.indexOf("#");if("query"===e.responseMode&&-1!==p?(v=s.substring(0,p),""!==(c=ae(s.substring(p+1,-1!==_?_:s.length),h)).paramsString&&(v+="?"+c.paramsString),-1!==_&&(v+=s.substring(_))):"fragment"===e.responseMode&&-1!==_&&(v=s.substring(0,_),""!==(c=ae(s.substring(_+1),h)).paramsString&&(v+="#"+c.paramsString)),c&&c.oauthParams)if("standard"===e.flow||"hybrid"===e.flow){if((c.oauthParams.code||c.oauthParams.error)&&c.oauthParams.state)return c.oauthParams.newUrl=v,c.oauthParams}else if("implicit"===e.flow&&(c.oauthParams.access_token||c.oauthParams.error)&&c.oauthParams.state)return c.oauthParams.newUrl=v,c.oauthParams}(t);if(o){var f=m.get(o.state);return f&&(o.valid=!0,o.redirectUri=f.redirectUri,o.storedNonce=f.nonce,o.prompt=f.prompt,o.pkceCodeVerifier=f.pkceCodeVerifier),o}}function ae(t,o){for(var f=t.split("&"),s={paramsString:"",oauthParams:{}},h=0;h<f.length;h++){var v=f[h].indexOf("="),c=f[h].slice(0,v);-1!==o.indexOf(c)?s.oauthParams[c]=f[h].slice(v+1):(""!==s.paramsString&&(s.paramsString+="&"),s.paramsString+=f[h])}return s}function P(){var t={setSuccess:function(o){t.resolve(o)},setError:function(o){t.reject(o)}};return t.promise=new es6Promise_min.exports.Promise(function(o,f){t.resolve=o,t.reject=f}),t.promise.success=function(o){return logPromiseDeprecation(),this.then(function(f){o(f)}),this},t.promise.error=function(o){return logPromiseDeprecation(),this.catch(function(f){o(f)}),this},t}function Z(){var t=P();if(!d.enable||d.iframe)return t.setSuccess(),t.promise;var o=document.createElement("iframe");d.iframe=o,o.onload=function(){var s=e.endpoints.authorize();d.iframeOrigin="/"===s.charAt(0)?window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""):s.substring(0,s.indexOf("/",8)),t.setSuccess()};var f=e.endpoints.checkSessionIframe();return o.setAttribute("src",f),o.setAttribute("title","keycloak-session-iframe"),o.style.display="none",document.body.appendChild(o),window.addEventListener("message",function(s){if(s.origin===d.iframeOrigin&&d.iframe.contentWindow===s.source&&("unchanged"==s.data||"changed"==s.data||"error"==s.data)){"unchanged"!=s.data&&e.clearToken();for(var h=d.callbackList.splice(0,d.callbackList.length),v=h.length-1;v>=0;--v){var c=h[v];"error"==s.data?c.setError():c.setSuccess("unchanged"==s.data)}}},!1),t.promise}function z(){d.enable&&e.token&&setTimeout(function(){$().then(function(t){t&&z()})},1e3*d.interval)}function $(){var t=P();if(d.iframe&&d.iframeOrigin){var o=e.clientId+" "+(e.sessionId?e.sessionId:"");d.callbackList.push(t),1==d.callbackList.length&&d.iframe.contentWindow.postMessage(o,d.iframeOrigin)}else t.setSuccess();return t.promise}function J(){var s,h,c,p,t=P();if(d.enable||e.silentCheckSsoRedirectUri){var o=document.createElement("iframe");o.setAttribute("src",e.endpoints.thirdPartyCookiesIframe()),o.setAttribute("title","keycloak-3p-check-iframe"),o.style.display="none",document.body.appendChild(o);var f=function(s){o.contentWindow===s.source&&("supported"!==s.data&&"unsupported"!==s.data||("unsupported"===s.data&&(d.enable=!1,e.silentCheckSsoFallback&&(e.silentCheckSsoRedirectUri=!1),L("[KEYCLOAK] 3rd party cookies aren't supported by this browser. checkLoginIframe and silent check-sso are not available.")),document.body.removeChild(o),window.removeEventListener("message",f),t.setSuccess()))};window.addEventListener("message",f,!1)}else t.setSuccess();return s=t.promise,h=e.messageReceiveTimeout,c=null,p=new es6Promise_min.exports.Promise(function(_,S){c=setTimeout(function(){S({error:"Timeout when waiting for 3rd party check iframe message."})},h)}),es6Promise_min.exports.Promise.race([s,p]).finally(function(){clearTimeout(c)})}function j(t){if(!t||"default"==t)return{login:function(s){return window.location.replace(e.createLoginUrl(s)),P().promise},logout:function(s){return window.location.replace(e.createLogoutUrl(s)),P().promise},register:function(s){return window.location.replace(e.createRegisterUrl(s)),P().promise},accountManagement:function(){var s=e.createAccountUrl();if(void 0===s)throw"Not supported by the OIDC server";return window.location.href=s,P().promise},redirectUri:function(s,h){return s&&s.redirectUri?s.redirectUri:e.redirectUri?e.redirectUri:location.href}};if("cordova"==t){d.enable=!1;var o=function(s,h,v){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(s,h,v):window.open(s,h,v)},f=function(s){var v,h=(v=s)&&v.cordovaOptions?Object.keys(v.cordovaOptions).reduce(function(c,p){return c[p]=v.cordovaOptions[p],c},{}):{};return h.location="no",s&&"none"==s.prompt&&(h.hidden="yes"),function(v){return Object.keys(v).reduce(function(c,p){return c.push(p+"="+v[p]),c},[]).join(",")}(h)};return{login:function(s){var h=P(),v=f(s),c=e.createLoginUrl(s),p=o(c,"_blank",v),_=!1,S=!1,I=function(){S=!0,p.close()};return p.addEventListener("loadstart",function(x){0==x.url.indexOf("http://localhost")&&(T(V(x.url),h),I(),_=!0)}),p.addEventListener("loaderror",function(x){_||(0==x.url.indexOf("http://localhost")?(T(V(x.url),h),I(),_=!0):(h.setError(),I()))}),p.addEventListener("exit",function(x){S||h.setError({reason:"closed_by_user"})}),h.promise},logout:function(s){var h,v=P(),c=e.createLogoutUrl(s),p=o(c,"_blank","location=no,hidden=yes,clearcache=yes");return p.addEventListener("loadstart",function(_){0==_.url.indexOf("http://localhost")&&p.close()}),p.addEventListener("loaderror",function(_){0==_.url.indexOf("http://localhost")||(h=!0),p.close()}),p.addEventListener("exit",function(_){h?v.setError():(e.clearToken(),v.setSuccess())}),v.promise},register:function(s){var h=P(),v=e.createRegisterUrl(),c=f(s),p=o(v,"_blank",c);return p.addEventListener("loadstart",function(_){0==_.url.indexOf("http://localhost")&&(p.close(),T(V(_.url),h))}),h.promise},accountManagement:function(){var s=e.createAccountUrl();if(void 0===s)throw"Not supported by the OIDC server";var h=o(s,"_blank","location=no");h.addEventListener("loadstart",function(v){0==v.url.indexOf("http://localhost")&&h.close()})},redirectUri:function(s){return"http://localhost"}}}if("cordova-native"==t)return d.enable=!1,{login:function(s){var h=P(),v=e.createLoginUrl(s);return universalLinks.subscribe("keycloak",function(c){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),T(V(c.url),h)}),window.cordova.plugins.browsertab.openUrl(v),h.promise},logout:function(s){var h=P(),v=e.createLogoutUrl(s);return universalLinks.subscribe("keycloak",function(c){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),e.clearToken(),h.setSuccess()}),window.cordova.plugins.browsertab.openUrl(v),h.promise},register:function(s){var h=P(),v=e.createRegisterUrl(s);return universalLinks.subscribe("keycloak",function(c){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),T(V(c.url),h)}),window.cordova.plugins.browsertab.openUrl(v),h.promise},accountManagement:function(){var s=e.createAccountUrl();if(void 0===s)throw"Not supported by the OIDC server";window.cordova.plugins.browsertab.openUrl(s)},redirectUri:function(s){return s&&s.redirectUri?s.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};throw"invalid adapter type: "+t}e.init=function(t){if(e.authenticated=!1,m=function(){try{return new G}catch(c){}return new Q}(),a=t&&["default","cordova","cordova-native"].indexOf(t.adapter)>-1?j(t.adapter):t&&"object"==typeof t.adapter?t.adapter:window.Cordova||window.cordova?j("cordova"):j(),t){if(void 0!==t.useNonce&&(R=t.useNonce),void 0!==t.checkLoginIframe&&(d.enable=t.checkLoginIframe),t.checkLoginIframeInterval&&(d.interval=t.checkLoginIframeInterval),"login-required"===t.onLoad&&(e.loginRequired=!0),t.responseMode){if("query"!==t.responseMode&&"fragment"!==t.responseMode)throw"Invalid value for responseMode";e.responseMode=t.responseMode}if(t.flow){switch(t.flow){case"standard":e.responseType="code";break;case"implicit":e.responseType="id_token token";break;case"hybrid":e.responseType="code id_token token";break;default:throw"Invalid value for flow"}e.flow=t.flow}if(null!=t.timeSkew&&(e.timeSkew=t.timeSkew),t.redirectUri&&(e.redirectUri=t.redirectUri),t.silentCheckSsoRedirectUri&&(e.silentCheckSsoRedirectUri=t.silentCheckSsoRedirectUri),e.silentCheckSsoFallback="boolean"!=typeof t.silentCheckSsoFallback||t.silentCheckSsoFallback,t.pkceMethod){if("S256"!==t.pkceMethod)throw"Invalid value for pkceMethod";e.pkceMethod=t.pkceMethod}e.enableLogging="boolean"==typeof t.enableLogging&&t.enableLogging,"string"==typeof t.scope&&(e.scope=t.scope),e.messageReceiveTimeout="number"==typeof t.messageReceiveTimeout&&t.messageReceiveTimeout>0?t.messageReceiveTimeout:1e4}e.responseMode||(e.responseMode="fragment"),e.responseType||(e.responseType="code",e.flow="standard");var o=P(),f=P();f.promise.then(function(){e.onReady&&e.onReady(e.authenticated),o.setSuccess(e.authenticated)}).catch(function(c){o.setError(c)});var s=function(c){var p,_=P();function S(M){e.endpoints=M?{authorize:function(){return M.authorization_endpoint},token:function(){return M.token_endpoint},logout:function(){if(!M.end_session_endpoint)throw"Not supported by the OIDC server";return M.end_session_endpoint},checkSessionIframe:function(){if(!M.check_session_iframe)throw"Not supported by the OIDC server";return M.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!M.userinfo_endpoint)throw"Not supported by the OIDC server";return M.userinfo_endpoint}}:{authorize:function(){return H()+"/protocol/openid-connect/auth"},token:function(){return H()+"/protocol/openid-connect/token"},logout:function(){return H()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var W=H()+"/protocol/openid-connect/login-status-iframe.html";return e.iframeVersion&&(W=W+"?version="+e.iframeVersion),W},thirdPartyCookiesIframe:function(){var W=H()+"/protocol/openid-connect/3p-cookies/step1.html";return e.iframeVersion&&(W=W+"?version="+e.iframeVersion),W},register:function(){return H()+"/protocol/openid-connect/registrations"},userinfo:function(){return H()+"/protocol/openid-connect/userinfo"}}}if(r?"string"==typeof r&&(p=r):p="keycloak.json",p)(A=new XMLHttpRequest).open("GET",p,!0),A.setRequestHeader("Accept","application/json"),A.onreadystatechange=function(){if(4==A.readyState)if(200==A.status||N(A)){var M=JSON.parse(A.responseText);e.authServerUrl=M["auth-server-url"],e.realm=M.realm,e.clientId=M.resource,S(null),_.setSuccess()}else _.setError()},A.send();else{if(!r.clientId)throw"clientId missing";e.clientId=r.clientId;var I=r.oidcProvider;if(I){var x,A;"string"==typeof I?(x="/"==I.charAt(I.length-1)?I+".well-known/openid-configuration":I+"/.well-known/openid-configuration",(A=new XMLHttpRequest).open("GET",x,!0),A.setRequestHeader("Accept","application/json"),A.onreadystatechange=function(){4==A.readyState&&(200==A.status||N(A)?(S(JSON.parse(A.responseText)),_.setSuccess()):_.setError())},A.send()):(S(I),_.setSuccess())}else{if(!r.url)for(var Y=document.getElementsByTagName("script"),q=0;q<Y.length;q++)if(Y[q].src.match(/.*keycloak\.js/)){r.url=Y[q].src.substr(0,Y[q].src.indexOf("/js/keycloak.js"));break}if(!r.realm)throw"realm missing";e.authServerUrl=r.url,e.realm=r.realm,S(null),_.setSuccess()}}return _.promise}();function h(){var c=function(S){S||(_.prompt="none"),e.login(_).then(function(){f.setSuccess()}).catch(function(I){f.setError(I)})},p=function(){var S=document.createElement("iframe"),I=e.createLoginUrl({prompt:"none",redirectUri:e.silentCheckSsoRedirectUri});S.setAttribute("src",I),S.setAttribute("title","keycloak-silent-check-sso"),S.style.display="none",document.body.appendChild(S);var x=function(A){A.origin===window.location.origin&&S.contentWindow===A.source&&(T(V(A.data),f),document.body.removeChild(S),window.removeEventListener("message",x))};window.addEventListener("message",x)},_={};switch(t.onLoad){case"check-sso":d.enable?Z().then(function(){$().then(function(S){S?f.setSuccess():e.silentCheckSsoRedirectUri?p():c(!1)}).catch(function(S){f.setError(S)})}):e.silentCheckSsoRedirectUri?p():c(!1);break;case"login-required":c(!0);break;default:throw"Invalid value for onLoad"}}function v(){var c=V(window.location.href);if(c&&window.history.replaceState(window.history.state,null,c.newUrl),c&&c.valid)return Z().then(function(){T(c,f)}).catch(function(p){f.setError(p)});t?t.token&&t.refreshToken?(O(t.token,t.refreshToken,t.idToken),d.enable?Z().then(function(){$().then(function(p){p?(e.onAuthSuccess&&e.onAuthSuccess(),f.setSuccess(),z()):f.setSuccess()}).catch(function(p){f.setError(p)})}):e.updateToken(-1).then(function(){e.onAuthSuccess&&e.onAuthSuccess(),f.setSuccess()}).catch(function(p){e.onAuthError&&e.onAuthError(),t.onLoad?h():f.setError(p)})):t.onLoad?h():f.setSuccess():f.setSuccess()}return s.then(function(){var c,p;(c=P(),p=function(){"interactive"!==document.readyState&&"complete"!==document.readyState||(document.removeEventListener("readystatechange",p),c.setSuccess())},document.addEventListener("readystatechange",p),p(),c.promise).then(J).then(v).catch(function(c){o.setError(c)})}),s.catch(function(c){o.setError(c)}),o.promise},e.login=function(t){return a.login(t)},e.createLoginUrl=function(t){var o,f=B(),s=B(),h=a.redirectUri(t),v={state:f,nonce:s,redirectUri:encodeURIComponent(h)};t&&t.prompt&&(v.prompt=t.prompt),o=t&&"register"==t.action?e.endpoints.register():e.endpoints.authorize();var c=t&&t.scope||e.scope;c?-1===c.indexOf("openid")&&(c="openid "+c):c="openid";var p=o+"?client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(h)+"&state="+encodeURIComponent(f)+"&response_mode="+encodeURIComponent(e.responseMode)+"&response_type="+encodeURIComponent(e.responseType)+"&scope="+encodeURIComponent(c);if(R&&(p=p+"&nonce="+encodeURIComponent(s)),t&&t.prompt&&(p+="&prompt="+encodeURIComponent(t.prompt)),t&&t.maxAge&&(p+="&max_age="+encodeURIComponent(t.maxAge)),t&&t.loginHint&&(p+="&login_hint="+encodeURIComponent(t.loginHint)),t&&t.idpHint&&(p+="&kc_idp_hint="+encodeURIComponent(t.idpHint)),t&&t.action&&"register"!=t.action&&(p+="&kc_action="+encodeURIComponent(t.action)),t&&t.locale&&(p+="&ui_locales="+encodeURIComponent(t.locale)),e.pkceMethod){var _=U(96,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789");v.pkceCodeVerifier=_,p+="&code_challenge="+function(I,x){if("S256"===I){var A=new Uint8Array(sha256.exports.sha256.arrayBuffer(x));return base64Js.fromByteArray(A).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}throw"Invalid value for pkceMethod"}(e.pkceMethod,_),p+="&code_challenge_method="+e.pkceMethod}return m.add(v),p},e.logout=function(t){return a.logout(t)},e.createLogoutUrl=function(t){return e.endpoints.logout()+"?redirect_uri="+encodeURIComponent(a.redirectUri(t,!1))},e.register=function(t){return a.register(t)},e.createRegisterUrl=function(t){return t||(t={}),t.action="register",e.createLoginUrl(t)},e.createAccountUrl=function(t){var o=H(),f=void 0;return void 0!==o&&(f=o+"/account?referrer="+encodeURIComponent(e.clientId)+"&referrer_uri="+encodeURIComponent(a.redirectUri(t))),f},e.accountManagement=function(){return a.accountManagement()},e.hasRealmRole=function(t){var o=e.realmAccess;return!!o&&o.roles.indexOf(t)>=0},e.hasResourceRole=function(t,o){if(!e.resourceAccess)return!1;var f=e.resourceAccess[o||e.clientId];return!!f&&f.roles.indexOf(t)>=0},e.loadUserProfile=function(){var t=H()+"/account",o=new XMLHttpRequest;o.open("GET",t,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","bearer "+e.token);var f=P();return o.onreadystatechange=function(){4==o.readyState&&(200==o.status?(e.profile=JSON.parse(o.responseText),f.setSuccess(e.profile)):f.setError())},o.send(),f.promise},e.loadUserInfo=function(){var t=e.endpoints.userinfo(),o=new XMLHttpRequest;o.open("GET",t,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","bearer "+e.token);var f=P();return o.onreadystatechange=function(){4==o.readyState&&(200==o.status?(e.userInfo=JSON.parse(o.responseText),f.setSuccess(e.userInfo)):f.setError())},o.send(),f.promise},e.isTokenExpired=function(t){if(!e.tokenParsed||!e.refreshToken&&"implicit"!=e.flow)throw"Not authenticated";if(null==e.timeSkew)return C("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var o=e.tokenParsed.exp-Math.ceil((new Date).getTime()/1e3)+e.timeSkew;if(t){if(isNaN(t))throw"Invalid minValidity";o-=t}return o<0},e.updateToken=function(t){var o=P();if(!e.refreshToken)return o.setError(),o.promise;t=t||5;var f=function(){var s=!1;if(-1==t?(s=!0,C("[KEYCLOAK] Refreshing token: forced refresh")):e.tokenParsed&&!e.isTokenExpired(t)||(s=!0,C("[KEYCLOAK] Refreshing token: token expired")),s){var h="grant_type=refresh_token&refresh_token="+e.refreshToken,v=e.endpoints.token();if(u.push(o),1==u.length){var c=new XMLHttpRequest;c.open("POST",v,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.withCredentials=!0,h+="&client_id="+encodeURIComponent(e.clientId);var p=(new Date).getTime();c.onreadystatechange=function(){if(4==c.readyState)if(200==c.status){C("[KEYCLOAK] Token refreshed"),p=(p+(new Date).getTime())/2;var _=JSON.parse(c.responseText);O(_.access_token,_.refresh_token,_.id_token,p),e.onAuthRefreshSuccess&&e.onAuthRefreshSuccess();for(var S=u.pop();null!=S;S=u.pop())S.setSuccess(!0)}else for(L("[KEYCLOAK] Failed to refresh token"),400==c.status&&e.clearToken(),e.onAuthRefreshError&&e.onAuthRefreshError(),S=u.pop();null!=S;S=u.pop())S.setError(!0)},c.send(h)}}else o.setSuccess(!1)};return d.enable?$().then(function(){f()}).catch(function(s){o.setError(s)}):f(),o.promise},e.clearToken=function(){e.token&&(O(null,null,null),e.onAuthLogout&&e.onAuthLogout(),e.loginRequired&&e.login())};var G=function(){if(!(this instanceof G))return new G;function t(){for(var o=(new Date).getTime(),f=0;f<localStorage.length;f++){var s=localStorage.key(f);if(s&&0==s.indexOf("kc-callback-")){var h=localStorage.getItem(s);if(h)try{var v=JSON.parse(h).expires;(!v||v<o)&&localStorage.removeItem(s)}catch(c){localStorage.removeItem(s)}}}}localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test"),this.get=function(o){if(o){var f="kc-callback-"+o,s=localStorage.getItem(f);return s&&(localStorage.removeItem(f),s=JSON.parse(s)),t(),s}},this.add=function(o){t();var f="kc-callback-"+o.state;o.expires=(new Date).getTime()+36e5,localStorage.setItem(f,JSON.stringify(o))}},Q=function(){if(!(this instanceof Q))return new Q;var t=this;t.get=function(h){if(h){var v=f("kc-callback-"+h);return s("kc-callback-"+h,"",o(-100)),v?JSON.parse(v):void 0}},t.add=function(h){s("kc-callback-"+h.state,JSON.stringify(h),o(60))},t.removeItem=function(h){s(h,"",o(-100))};var o=function(h){var v=new Date;return v.setTime(v.getTime()+60*h*1e3),v},f=function(h){for(var v=h+"=",c=document.cookie.split(";"),p=0;p<c.length;p++){for(var _=c[p];" "==_.charAt(0);)_=_.substring(1);if(0==_.indexOf(v))return _.substring(v.length,_.length)}return""},s=function(h,v,c){var p=h+"="+v+"; expires="+c.toUTCString()+"; ";document.cookie=p}};function ne(t){return function(){e.enableLogging&&t.apply(console,Array.prototype.slice.call(arguments))}}}return Keycloak});